(function(c){var d={PROJECT:0,INFO:1,DESIGNER:2,SALESMAN:3,QUESTION:4,INFOFILE:5},h=function(a){this.type(a)};h.prototype.type=function(a){if(void 0===a)return this.Type;this.Type=+a};h.prototype.baseUrl=function(){var a=h.host;switch(this.Type){case d.INFO:a+="/InfoSearch.aspx";break;case d.PROJECT:a+="/ProjectSearch.aspx";break;case d.DESIGNER:a+="/DesignerSearch.aspx";break;case d.SALESMAN:a+="/SalesmanSearch.aspx";break;case d.QUESTION:a+="/QuestionSearch.aspx";break;case d.INFOFILE:a+="/InfoFileSearch.aspx";
break;default:a+="/Index.aspx"}return a};h.prototype.searchUrl=function(a,e){var d=this.baseUrl();e=c.extend({},e||{});a&&!c.trim(a)&&(e.kw=a);var b=[],k;for(k in e)b.push(k+"="+escape(e[k]));return 0<b.length?d+"?"+b.join("&"):d};h.host="http://search.tgnet.com";var r=c(),l=c(),n=null,s=function(){n||(n=TG.jsLoader("http://js.tgimg.cn/jquery/1.4/jquery.assign.min.js",function(){c(document).bind("click.search_tips_list",function(a){a=c(a.target);0<r.filter(a).length?(a=a.data("search_tips_list"),
l.not(a).toggle(!1),a.toggle(!0)):0<l.filter(a).length?(l.not(a).toggle(!1),a.toggle(!0)):0<(a=l.has(a)).length?(l.not(a).toggle(!1),a.toggle(!0)):l.toggle(!1)})}));return n},t=function(a,e){function q(){c(this).siblings().find("a.hover").removeClass("hover");c("a",this).addClass("hover");g=c(this).data("index")}var b=new a,k=TG.timer(300),p=e.inputElem,f=e.listElem,m=null,g=-1;new h(d.PROJECT);c.merge(r,p.data("search_tips_list",f));c.merge(l,f);b.parent(f,!0,e.template);b.bind(b.Event.ITEMCOMPLETE,
function(a,b,f,d){e.reviseItemFn(void 0===f.Count,b);b.hover(q,c.noop).data("index",d)});b.bind(b.Event.COMPLETE,function(){f.data("index",b.count()).toggle(!!m)});f.hover(q,c.noop);p.focus(function(){k.start()}).blur(function(){m=null;g=-1;k.stop()}).keyup(function(a){if(40==a.which)g++,g>b.count()&&(g=0);else if(38==a.which)g--,0>g&&(g=b.count());else return!0;f.find("a").removeClass("hover").eq(g).addClass("hover");return!1}).enter(function(){if(-1<g){var a=f.find("a").eq(g);"http://search.tgnet.com/ProjectSearch.aspx"!=
a.attr("href")?(c(".tbKeyword").val(a.html()),c("input[type=submit]").trigger("click")):a.triggerHandler("click");return!1}});f.delegate("a","click",function(a){a=a||window.event;var b=c(this).attr("href");null!=b.match(/(search\.tgnet\.com)|(search2\.tgnet\.com)/gi)||"javascript:;"==b?(c(this).hasClass("styleSearch")?(b=b.substring(b.lastIndexOf("pc=")+3),window.location="/CompanyService/ProjList.aspx?cnl="+b):(c(".tbKeyword").val(c(this).find("span").text()),c(".ordinarySearch").click()),a.preventDefault()):
c(this).trigger("click")});k.bind(function(){var a=c.trim(p.val());f.toggle(!!a);a&&m!=a&&(m=a,e.onValueChange(a),b.mode(a),b.limit(e.limit),b.request({url:"http://search.tgnet.com/System/AjaxService.aspx?op=getprojsearchtips",dataType:"jsonp",data:{key:escape(a)}}),b.refresh())});return b};h.bindSearchTipsList=function(a){s().done(function(){t(Assign,a)})};window.TG=window.TG||{};TG.Search=h;TG.SearchType=d;TG.SearchTipsListArgs=function(a,e,d,b,k,h,f){this.inputElem=c(a);this.listElem=c(e);this.template=
d;this.reviseItemFn=b;this.limit=k;this.onValueChange=h||c.noop;this.commonSearchBtn=f&&c(f)}})(jQuery);
